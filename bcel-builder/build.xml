<project default="unpackAndJar" basedir=".">

  <target name="unpackAndJar" depends="unpack,jar" />

  <target name="jar">
    <copy file="../lib/regexp/jakarta-regexp-1.2.jar"
        tofile="bcel/lib/Regex.jar" />
    <ant dir="bcel" target="jar" />
    <copy file="bcel/bin/bcel.jar" toDir="." />
  </target>

  <target name="update">
    <copy file="bcel.jar" todir="../lib/bcel" />
  </target>

  <target name="pack">
    <move toDir="bcel/src/java">
      <fileset dir="src" />
    </move>
  </target>

  <target name="unpack" depends="extract,patch,srcclean">
    <move toDir="src">
      <fileset dir="bcel/src/java" />
    </move>
  </target>

  <target name="extract">
    <unzip src="bcel-5.1-src.zip" dest="." />
  </target>

  <target name="srcclean">
    <delete dir="src/org" />
  </target>

  <target name="clean" depends="srcclean">
    <delete dir="bcel-5.1" />
    <delete dir="bcel" />
  </target>

  <target name="patch">
    <copy todir="bcel">
      <fileset dir="bcel-5.1" />
    </copy>
    <patch patchfile="patch.txt" strip="1" dir="bcel" />
  </target>

  <target name="diff">
    <exec dir="." executable="diff.exe" output="patch.txt">
      <arg line="-N"/>
      <arg line="-a"/>
      <arg line="-u"/>
      <arg line="-r"/>
      <arg line="-b"/>
      <arg line="bcel-5.1" />
      <arg line="bcel" />
    </exec>
  </target>

</project>
